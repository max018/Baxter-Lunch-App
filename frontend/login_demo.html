<!doctype html>
<html>
  <head>
    <title>Sign-In Demo</title>

    <script>
      function doSignIn() {
        googleAuth.signIn().then(function(){
          window.location.reload();
        });
      }
      function doSignOut() {
        googleAuth.signOut().then(function(){
          window.location.reload();
        });
      }

      function googleAuthReady() {
        if (googleAuth.isSignedIn.get()) {
          var html = '<button onclick="doSignOut()">sign out</button><br>',
              googleUser = googleAuth.currentUser.get(),
              profile = googleUser.getBasicProfile();
          html += "ID: " + profile.getId(); // Don't send this directly to your server!
          html += "Full Name: " + profile.getName();
          html += "Given Name: " + profile.getGivenName();
          html += "Family Name: " + profile.getFamilyName();
          html += "Image URL: " + profile.getImageUrl();
          html += "Email: " + profile.getEmail();

          // The ID token you need to pass to your backend:
          var id_token = googleUser.getAuthResponse().id_token;
          html += "ID Token: " + id_token;

          document.querySelector("#main").innerHTML = html;
        }
        else {
          document.querySelector("#main").innerHTML = '<button onclick="doSignIn()">sign in</button>';
        }
      }
    </script>

    <!-- copy-pastable section begins -->
    <meta name="google-signin-scope" content="profile email">
    <script src="id.js"></script>
    <script>
      var googleAuth;

      function onGAPILoad() {
        gapi.load('auth2', function() {
          googleAuth = gapi.auth2.init({client_id: CLIENT_ID});
          googleAuth.then(googleAuthReady);
        });
      };

      // A 'googleAuthReady' callback will be expected to exist.
      // In subsequent code, use the global variable 'googleAuth'.
      // googleAuth is a gapi.auth2.GoogleAuth (https://goo.gl/mDwEFB)
    </script>
    <script src="https://apis.google.com/js/platform.js?onload=onGAPILoad" async defer></script>
    <!-- copy-pastable section ends -->
  </head>
  <body>
    <div id="main">loading...</div>
  </body>
</html>

